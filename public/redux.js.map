{"version":3,"sources":["../src/redux.js"],"names":["combineReducers","obj","type","initialState","keys","Object","forEach","key","undefined","state","action","nextState","assign","applyMiddleware","middlewares","store","createStore","middlewareRes","map","item","composedMiddleware","length","reduce","a","b","next","newDispatch","dispatch","reducer","enhancedCreateStore","result","actionObj","getState"],"mappings":";;;;;;;;AAAA,IAAMA,kBAAkB,SAAlBA,eAAkB,CAACC,GAAD,EAAS;AAChC,KAAMC,OAAO,OAAb;AACA,KAAMC,eAAe,EAArB;AACA,KAAMC,OAAOC,OAAOD,IAAP,CAAYH,GAAZ,CAAb;AACAG,MAAKE,OAAL,CAAa,eAAO;AACnBH,eAAaI,GAAb,IAAoBN,IAAIM,GAAJ,EAASC,SAAT,EAAoB,EAAEN,UAAF,EAApB,CAApB;AACA,EAFD;AAGA,QAAO,YAAwC;AAAA,MAA9BO,KAA8B,uEAAtBN,YAAsB;AAAA,MAARO,MAAQ;;AAC9C,MAAIC,YAAYN,OAAOO,MAAP,CAAc,EAAd,EAAkBH,KAAlB,CAAhB;AACA,MAAIC,UAAUA,OAAOR,IAArB,EAA2B;AAC1BE,QAAKE,OAAL,CAAa,eAAO;AACnBK,cAAUJ,GAAV,IAAiBN,IAAIM,GAAJ,EAASE,MAAMF,GAAN,CAAT,EAAqBG,MAArB,CAAjB;AACA,IAFD;AAGA;AACD,SAAOC,SAAP;AACA,EARD;AASA,CAhBD;;AAkBA,IAAME,kBAAkB,SAAlBA,eAAkB;AAAA,mCAAIC,WAAJ;AAAIA,aAAJ;AAAA;;AAAA,QACvB;AAAA,SAAe,YAAa;AAC3B,OAAMC,QAAQC,uCAAd;AACA;;;;;;;;;;;;;;;;;AAiBA,OAAMC,gBAAgBH,YAAYI,GAAZ,CAAgB;AAAA,WAAQC,KAAKJ,KAAL,CAAR;AAAA,IAAhB,CAAtB;AACA,OAAIK,2BAAJ;AACA,OAAIH,cAAcI,MAAd,KAAyB,CAA7B,EAAgC;AAC/BD,yBAAqBH,cAAc,CAAd,CAArB;AACA,IAFD,MAEO;AACNG,yBAAqBH,cAAcK,MAAd,CAAqB,UAACC,CAAD,EAAIC,CAAJ;AAAA,YAAU;AAAA,aAAQD,EAAEC,EAAEC,IAAF,CAAF,CAAR;AAAA,MAAV;AAAA,KAArB,CAArB;AACA;AACD,OAAMC,cAAcN,mBAAmBL,MAAMY,QAAzB,CAApB;AACA,uBACIZ,KADJ;AAECY,cAAUD;AAFX;AAIA,GA/BD;AAAA,EADuB;AAAA,CAAxB;;AAkCA,IAAMV,cAAc,SAAdA,WAAc,CAACY,OAAD,EAAUzB,YAAV,EAAwB0B,mBAAxB,EAAgD;AACnE,KAAIpB,QAAQN,gBAAgByB,QAAQpB,SAAR,EAAmB,EAAEN,MAAM,OAAR,EAAnB,CAA5B;AACA,KAAI2B,uBAAuB,OAAOA,mBAAP,KAA+B,UAA1D,EAAsE;AACrE,SAAOA,oBAAoBb,WAApB,EAAiCY,OAAjC,EAA0CzB,YAA1C,CAAP;AACA;AACD,KAAM2B,SAAS;AACdH,YAAU,oBAAoB;AAAA,OAAnBI,SAAmB,uEAAP,EAAO;;AAC7BtB,WAAQmB,QAAQnB,SAASD,SAAjB,EAA4BuB,SAA5B,CAAR;AACA,UAAOD,MAAP;AACA,GAJa;AAKd;AACAE,YAAU,oBAAM;AACf,UAAOvB,KAAP;AACA;AARa,EAAf;AAUA,QAAOqB,MAAP;AACA,CAhBD;;QAkBSd,W,GAAAA,W;QAAahB,e,GAAAA,e;QAAiBa,e,GAAAA,e","file":"redux.js","sourcesContent":["const combineReducers = (obj) => {\n\tconst type = '@INIT';\n\tconst initialState = {};\n\tconst keys = Object.keys(obj);\n\tkeys.forEach(key => {\n\t\tinitialState[key] = obj[key](undefined, { type });\n\t});\n\treturn function (state = initialState, action) {\n\t\tlet nextState = Object.assign({}, state);\n\t\tif (action && action.type) {\n\t\t\tkeys.forEach(key => {\n\t\t\t\tnextState[key] = obj[key](state[key], action);\n\t\t\t});\n\t\t}\n\t\treturn nextState;\n\t}\n};\n\nconst applyMiddleware = (...middlewares) =>\n\tcreateStore => (...args) => {\n\t\tconst store = createStore(...args);\n\t\t/** 获取装饰过的 dispatch\n    * 最终得到的 middlewareRes 为：\n    * [\n    *   function anonymousFn1(next) {\n    *      return function fn1(action) {\n    *        console.log('middleware1');\n    *        return next(action);\n    *      }\n    *   },\n    *   function anonymousFn2(next) {\n    *      return function fn2(action) {\n    *        console.log('middleware2');\n    *        return next(action);\n    *      }\n    *   }\n    * ]\n    */\n\t\tconst middlewareRes = middlewares.map(item => item(store));\n\t\tlet composedMiddleware;\n\t\tif (middlewareRes.length === 1) {\n\t\t\tcomposedMiddleware = middlewareRes[0];\n\t\t} else {\n\t\t\tcomposedMiddleware = middlewareRes.reduce((a, b) => next => a(b(next)));\n\t\t}\n\t\tconst newDispatch = composedMiddleware(store.dispatch);\n\t\treturn ({\n\t\t\t...store,\n\t\t\tdispatch: newDispatch,\n\t\t});\n\t}\n\nconst createStore = (reducer, initialState, enhancedCreateStore) => {\n\tlet state = initialState || reducer(undefined, { type: '@INIT' });\n\tif (enhancedCreateStore && typeof enhancedCreateStore === 'function') {\n\t\treturn enhancedCreateStore(createStore)(reducer, initialState);\n\t}\n\tconst result = {\n\t\tdispatch: (actionObj = {}) => {\n\t\t\tstate = reducer(state || undefined, actionObj);\n\t\t\treturn result;\n\t\t},\n\t\t// getState 返回当前的 store\n\t\tgetState: () => {\n\t\t\treturn state;\n\t\t},\n\t};\n\treturn result;\n};\n\nexport { createStore, combineReducers, applyMiddleware };\n"]}